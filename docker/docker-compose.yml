services:
  gosir:
    image: gosir:latest
    build:
      context: ..
      dockerfile: docker/Dockerfile
      tags:
        - gosir:latest
    container_name: gosir-app
    ports:
      - "${GOSIR_SERVER_PORT:-1323}:1323"
    environment:
      # 服务器配置
      - GOSIR_SERVER_PORT=1323
      - GOSIR_SERVER_MODE=release
      # 数据库配置
      - GOSIR_DATABASE_PATH=/app/data/data.db
      - GOSIR_DATABASE_LOG_LEVEL=warn
      # JWT配置
      - GOSIR_JWT_SECRET=XC0VfuGRumdG47PqxvqC7OIDWuyGY0bUVr6+o1CHHoY=
      - GOSIR_JWT_EXPIRE_HOURS=24
      # 日志配置
      - GOSIR_LOG_LEVEL=info
      - GOSIR_LOG_PATH=/app/logs/app.log
      - GOSIR_LOG_FORMAT=json
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      - ../config/config.yaml:/app/config/config.yaml:ro
    restart: unless-stopped
    networks:
      - gosir-network

networks:
  gosir-network:
    driver: bridge
